/**
 * EasyTemplateJS-express
 * 
 * Version 3.0.1
 * 
 * http://easyproject.cn 
 * https://github.com/ushelp
 * 
 * Copyright 2012 Ray [ inthinkcolor@gmail.com ]
 * Released under the MIT license
 * 
 * [Support AMD, CMD, CommonJS, Node.js, express, expressjs, EasyTemplateJS]
 * 
 */

var fs=require("fs"),Et=require("easytemplatejs"),defaultSettings={cache:!0,enableScript:!0,enableStyle:!0},cacheTpl={};exports=module.exports=function(a,b){b=Object.assign({},defaultSettings,b),Et.enableScript=b.enableScript,Et.enableStyle=b.enableScript,a.engine("etj",function(a,c,d){fs.readFile(a,"utf-8",function(e,f){if(e)return d(e);var g;b.cache?(cacheTpl[a]||(cacheTpl[a]=Et.template(f)),g=cacheTpl[a]):g=Et.template(f);var h=g(c);return d(null,h)})}),a.set("views",b.views),a.set("view engine","etj")},exports.templateEngine=Et;